<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Mini 3D Stable</title>
<style>
  body { margin:0; overflow:hidden; font-family: Arial; }
  #scoreboard { position: absolute; top: 10px; left: 10px; color: white; background: rgba(0,0,0,0.5); padding: 5px; border-radius: 5px;}
</style>
</head>
<body>
<div id="scoreboard">Score: 0</div>
<script src="https://cdn.jsdelivr.net/npm/three@0.156.1/build/three.min.js"></script>

<script>
// === Scène, caméra, rendu ===
const scene = new THREE.Scene();
scene.background = new THREE.Color(0x87ceeb);

const camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
camera.position.set(0,5,10);

const renderer = new THREE.WebGLRenderer();
renderer.setSize(window.innerWidth, window.innerHeight);
document.body.appendChild(renderer.domElement);

// Lumière
const light = new THREE.DirectionalLight(0xffffff,1);
light.position.set(5,10,5);
scene.add(light);
scene.add(new THREE.AmbientLight(0x404040));

// Sol
const sol = new THREE.Mesh(
  new THREE.BoxGeometry(50,1,50),
  new THREE.MeshPhongMaterial({color:0x654321})
);
sol.position.y=-0.5;
scene.add(sol);

// Joueur
const joueur = new THREE.Mesh(
  new THREE.BoxGeometry(1,2,1),
  new THREE.MeshPhongMaterial({color:0x00ff00})
);
joueur.position.y=1;
scene.add(joueur);

// Arbres
const arbres = [];
const scoreElem = document.getElementById("scoreboard");
let score = 0;

for(let i=0;i<5;i++){
  const arbre = new THREE.Mesh(
    new THREE.CylinderGeometry(0.5,0.5,3,8),
    new THREE.MeshPhongMaterial({color:0x8B4513})
  );
  arbre.position.set(Math.random()*20-10,1.5,Math.random()*20-10);
  scene.add(arbre);
  arbres.push(arbre);
}

// Déplacement
const vitesse = 0.2;
const keys = { w:false, s:false, a:false, d:false };
document.addEventListener('keydown',e=>{
  if(e.key==='w') keys.w=true;
  if(e.key==='s') keys.s=true;
  if(e.key==='a') keys.a=true;
  if(e.key==='d') keys.d=true;
});
document.addEventListener('keyup',e=>{
  if(e.key==='w') keys.w=false;
  if(e.key==='s') keys.s=false;
  if(e.key==='a') keys.a=false;
  if(e.key==='d') keys.d=false;
});

// Clic pour supprimer arbre
document.addEventListener('mousedown', e=>{
  if(e.button===0){
    const raycaster = new THREE.Raycaster();
    const mouse = new THREE.Vector2(0,0);
    raycaster.setFromCamera(mouse,camera);
    const intersects = raycaster.intersectObjects(arbres);
    if(intersects.length>0){
      const arbre = intersects[0].object;
      scene.remove(arbre);
      arbres.splice(arbres.indexOf(arbre),1);
      score++;
      scoreElem.innerText = "Score: "+score;
    }
  }
});

// Boucle
function animate(){
  requestAnimationFrame(animate);

  // Mouvement joueur
  if(keys.w) joueur.position.z -= vitesse;
  if(keys.s) joueur.position.z += vitesse;
  if(keys.a) joueur.position.x -= vitesse;
  if(keys.d) joueur.position.x += vitesse;

  // Caméra suit joueur
  camera.position.set(joueur.position.x, joueur.position.y+5, joueur.position.z+10);
  camera.lookAt(joueur.position);

  renderer.render(scene,camera);
}

animate();
</script>
</body>
</html>
